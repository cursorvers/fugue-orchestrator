name: line-get-followers (one-time)

on:
  workflow_dispatch: {}

permissions:
  contents: read

jobs:
  get-followers:
    runs-on: ubuntu-latest
    timeout-minutes: 2
    steps:
      - name: Fetch follower IDs via LINE Messaging API
        env:
          LINE_CHANNEL_ACCESS_TOKEN: ${{ secrets.LINE_CHANNEL_ACCESS_TOKEN }}
        run: |
          set -euo pipefail
          echo "=== LINE Bot Info ==="
          curl -sS https://api.line.me/v2/bot/info \
            -H "Authorization: Bearer ${LINE_CHANNEL_ACCESS_TOKEN}" | jq .
          echo ""
          echo "=== Follower IDs ==="
          curl -sS https://api.line.me/v2/bot/followers/ids \
            -H "Authorization: Bearer ${LINE_CHANNEL_ACCESS_TOKEN}" | jq .
